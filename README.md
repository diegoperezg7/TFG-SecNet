# 🔐 SecNet: Automated Incident Response & Forensic Analysis System

**SecNet** is a comprehensive automated system for network security incident detection, response, and forensic analysis. Developed as a Final Project (TFG) for the Higher Technician in Computer Network Systems Management (ASIR), it demonstrates how an open-source-based solution can provide active protection and forensic visibility in controlled or educational environments with limited resources. Final grade 10/10.

---

## 🧠 Overview

SecNet enables real-time detection of malicious traffic using **Suricata** as the IDS/IPS engine, automates incident response with Python scripts, and facilitates basic forensic analysis through an intuitive web interface. The entire system runs inside **Docker** containers, making it easy to deploy and portable.

---

## 📸 Screenshots

**Main Dashboard** – Key metrics (total alerts, high severity, blocked IPs, last 24h) + graphs showing alert types and severity distribution

![Captura de pantalla 2025-06-07 102039](https://github.com/user-attachments/assets/6916ddce-7a1e-4c9d-b266-9e139544efc1)

**Blocked IPs and Recent Alerts** – Dashboard extension for prioritized action

![Captura de pantalla 2025-06-11 110600](https://github.com/user-attachments/assets/b60c0512-a487-4dca-8dd7-60ec2a90a41d)

**Alert List** – Filterable table by date, severity, protocol; actions for view/block

![Captura de pantalla 2025-06-07 102156](https://github.com/user-attachments/assets/6411225b-4565-43da-a42f-05c79157a3d8)

**Severity 3 Alert Details** – SSH brute-force attempt blocked instantly

![Captura de pantalla 2025-06-11 110344](https://github.com/user-attachments/assets/fb773c7f-893e-4d26-ab22-753153a2e819)

**Severity 2 Alert Details** – SYN scan to HTTP detected

![Captura de pantalla 2025-06-11 110217](https://github.com/user-attachments/assets/58c1cea7-4039-478e-84e7-23d9f33b6b1d)

**Severity 1 Alert Details** – Benign/noisy ICMP

![Captura de pantalla 2025-06-11 110035](https://github.com/user-attachments/assets/f386d9ed-84af-4c8c-8b49-9ce696d44dcc)

**Raw JSON Data** – Suricata raw logs (flow_id, payload, SID, etc.) for forensic review

![Captura de pantalla 2025-06-11 110359](https://github.com/user-attachments/assets/87f1d9b9-ef38-4a60-bb46-774f4e3f399a)

---

## 🛑 Alert Severity Table

The severity of each alert helps prioritize incident response and analysis. The levels are:

| Severity Level                     | Code | Description                                                                                                                        |
|-----------------------------------|------|------------------------------------------------------------------------------------------------------------------------------------|
| 🔴 High (Critical)                | 3    | Indicates serious threats that require immediate action, as they can compromise system security or network integrity. <br>Examples:<br>• SSH Brute Force Attempt<br>• SMB Enumeration Attempt<br>• Telnet Connection Attempt |
| 🟡 Medium (Warning)               | 2    | Signs of suspicious activity or reconnaissance attempts. Should be monitored and may require action if repeated.<br>Examples:<br>• Nmap HTTP Scan<br>• High DNS Query Volume<br>• SSL/TLS Connection Attempt<br>• MS-SQL Connection Attempt<br>• MySQL Connection Attempt<br>• SMTP Connection Attempt<br>• SYN Scan to HTTP port |
| 🟢 Low (Informational)            | 1    | Generally legitimate or low-risk activity, useful for context or pattern analysis. No immediate action required.<br>Example:<br>• ICMP Ping (Network Scan) |

> The automatic event classification enables efficient reaction and reduces false positives.

---

## ⚙️ Project Architecture

- 📁 **suricata/**: IDS/IPS configuration and custom rules
- 📁 **python-responder/**: Automated response script
- 📁 **logs/**: Logs generated by Suricata (`eve.json`, `suricata.log`)
- 📁 **database/**: SQLite database with processed alerts
- 📁 **web-interface/**: Web UI to visualize and manage alerts
- `docker-compose.yml`: Full orchestration using Docker

---

## 🚀 Main Components

- **Suricata**: IDS/IPS engine that detects and blocks malicious traffic (af-packet mode)
- **Responder.py**: Python script that parses logs (`eve.json`), stores alerts in SQLite and triggers automatic responses (e.g., blocking IPs)
- **Web Interface (PHP + JS)**: Allows real-time visualization and management of alerts
- **Docker**: Enables portable and reproducible deployment

---

## 📦 Requirements

- Docker and Docker Compose installed
- Linux OS (recommended: Kali, Debian, or Ubuntu)
- Active network interface (default is `eth0`, configurable in `suricata.yaml`)
- Python 3.8+, PHP 7.4+, Suricata, SQLite3, iptables

